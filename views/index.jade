extends layout

block content
  if !user
    header.bar-title
      h1.title CloudBucket
    .content
      .content-padded
        p Welcome to CloudBucket - online cloud storage with semantic search capability
        br
        a.button.button-positive.button-block(href='/auth/google', data-ignore='push') Login with Google
  else
    header.bar-title
      h1.title CloudBucket
      a.button(href='#uploadModal', data-transition='fade') Upload
    include _footer
    .content
        ul.list
          for file in files
            li(class='icon-#{file.extension}')
              a(href='/files/#{file.id}')
                strong #{file.name}
                br
                small(id='file-size-#{file.id}') #{file.size}
                small , modified&nbsp;
                small(id='last-modified-#{file.id}') #{file.lastModified}
            script
              $(function() {
                function updateFileFormating() {
                  var prettyDate = moment('#{file.lastModified}').fromNow();
                  $('#last-modified-#{file.id}').text(prettyDate);
                }

                // Update file formatting when transitioning between the app tabs
                window.addEventListener('push', function() {
                  updateFileFormating();
                });

                // Also set file formatting upon DOM load
                updateFileFormating();
              });

    #uploadModal.modal
      header.bar-title
        h1.title Upload a file
        a.button(href='#uploadModal') Cancel
      .content.content-padded
        form(action='/files', method='POST', enctype='multipart/form-data')
          input(type='file', name='myFile')
          br
          br
          button.button-main(type='submit') Upload a File
