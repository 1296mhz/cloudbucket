extends layout

block content
  if !user
    .container
      .swiper-container
        .swiper-wrapper
          .swiper-slide.text-center
            .intro-page
              h1
                span.text-muted.entypo.entypo-lg &#9729;
                span.text-primary.entypo.entypo-lg &#128254;
                div Cloud
                  strong Bucket
              h4.text-muted Online cloud storage with semantic search capability.
              hr
              p
                span.entypo &#128214;
                em  Swipe left
                |  to learn more

              br
              a.button.is-primary.btn-block(href='/auth/google') Sign in with Google
          .swiper-slide.text-center
            h3 Automatic Tagging
            p Whenever you upload files to Cloudbucket they be tagged
              | automatically based on the file contents. For instance, music files
              | will receive a covert art, lyrics, similar artists and tags that
              | describe that particular song.
          .swiper-slide.text-center
            h3 Semantic Search
            p All of your uploaded files are searchable not only by file names,
              | but also by the file contents and automatically generated metadata.
      .pagination
  else
    include _header
    .container
      .input-group.search-bar.fadeInRight.animated
        input.form-control(type='text', id='search-field', placeholder='Search all items by name or keywords')
        span.input-group-btn
          button.btn.btn-primary(type='button', id='search-btn')
            span.glyphicon.glyphicon-search
            |  Search

      if files.length < 1
        h3.text-center You do not have any files yet
      else
        table.fadeInRight.animated.file-table.table.table-hover.table-bordered
          tbody.file-tbody
            for file in files
              tr.file-row
                td.file-item(id='#{file.id}')
                  a(href='/files/#{file.id}')
                    strong= file.name
                  span.file-size.text-muted= file.friendlySize

  script.
    $('body').addClass('no-bg');
    var mySwiper = new Swiper('.swiper-container',{
      pagination: '.pagination',
      loop:true,
      grabCursor: true,
      paginationClickable: true
    });

    $('.file-item a').click(function(e) {
      //e.preventDefault();
      $(this).parent().addClass('fadeOutLeft animated');
    });

    $('#search-field').keydown(function(event) {
      if (event.keyCode == 13) {
        $('#search-btn').trigger('click');
      }
    });
    $('#search-btn').click(function() {
      var qs = $('#search-field').val();
      $('.file-tbody').html('');
      $('.file-table').hide();
      humane.log('Loading...');
      $.get('/search?q=' + qs, function(data) {
        $('.file-table').show();
        $.each(data.files, function(idx, file) {
          $('.file-tbody').append('<tr class="file-row">' +
            '<td class="file-item" id="' + file.id + '">' +
            '<a href="/files/' + file._id + '"><strong>' + file.name + '</strong></a>' +
            '<span class="file-size text-muted">' + file.friendlySize + '</span>' +
            '</td></tr>');
        });

        console.log(data); // files

      });
    });
          