extends layout

block content
  include _header
  .container
    table.table
      thead
        tr
          th.text-center Disk Usage
          th.text-center Name
          th.text-center Email
          th.text-center Actions
      tbody
        for u in userList
          tr
            td
              - var percent = Math.ceil(u.diskUsage / u.diskQuota * 100)
              .chart(data-percent=percent) 
                span= percent
                | %
            td #{u.displayName}
            td #{u.email}
            td
              .btn-group
                a.btn.btn-sm.btn-danger(id='delete', data-user='#{u.googleId}')
                  span.glyphicon.glyphicon-trash
                a.btn.btn-sm.btn-info(id='quota', data-user='#{u.googleId}')
                  span.glyphicon.glyphicon-dashboard

  script.
    // disk usage circle
    $('.chart').easyPieChart({
      size: 80,
      animate: 800,
      onStep: function(value) {
        this.$el.find('span').text(~~value);
      }
    });

    // delete user confirmation
    $('a#delete').click(function() {
      var answer = confirm('Are you sure you want to delete the user?');
      var user = $(this).data('user');
      if (answer) {
        $.ajax({
          url: '/admin/users/' + user,
          type: 'DELETE',
          success: function(result) {
              // Do something with the result
          }
        });
      }
    });


